---
layout: default
---

{%- comment -%}
å…ˆè¨ˆç®—å­—æ•¸ï¼ˆç„¡éœ€ pluginï¼‰ï¼šå» HTMLã€å£“ç©ºç™½ã€split ç©ºç™½ï¼Œå†å– size
{%- endcomment -%}
{% assign words = page.content | strip_html | normalize_whitespace | split: ' ' %}

<div class="post-layout">
  <!-- å·¦å´ç›®éŒ„ -->
  <nav class="post-toc">
    <div class="toc-header">
      <h3>ğŸ“‹ æ–‡ç« ç›®éŒ„</h3>
    </div>
    <div class="toc-content" id="toc"></div>
  </nav>

  <!-- ä¸»è¦å…§å®¹ -->
  <article class="post-main" data-count-key="post:{{ page.id | replace: '/', ':' }}">
    <header class="post-header">
      <h1>{{ page.title }}</h1>
      <div class="post-meta">
        <span class="post-date">ğŸ“… {{ page.date | date: "%Y-%m-%d" }}</span>

        {% if page.categories %}
          <span class="post-categories">
            ğŸ“ åˆ†é¡ï¼š
            {% for c in page.categories %}
              <a href="{{ '/categories.html#' | append: c | relative_url }}">{{ c }}</a>{% unless forloop.last %} / {% endunless %}
            {% endfor %}
          </span>
        {% endif %}

        {% if page.tags %}
          <span class="post-tags">
            ğŸ·ï¸ æ¨™ç±¤ï¼š
            {% for t in page.tags %}
              <a href="{{ '/tags.html#' | append: t | slugify | relative_url }}">{{ t }}</a>{% unless forloop.last %} / {% endunless %}
            {% endfor %}
          </span>
        {% endif %}

        <span class="reading-time">â±ï¸ é–±è®€æ™‚é–“ï¼šç´„ {{ words | size | divided_by:200 | ceil }} åˆ†é˜</span>
      </div>
    </header>

    <div class="post-content">
      {{ content }}
    </div>

    <footer class="post-footer">
      <div class="post-views">
        <strong>ğŸ‘ï¸ ç€è¦½æ•¸ï¼š</strong><span id="view-count">â€¦</span>
      </div>
    </footer>
  </article>

  <!-- å³å´é‚Šæ¬„ -->
  <aside class="post-sidebar">
    <div class="sidebar-section">
      <h4>ğŸ“ˆ é–±è®€é€²åº¦</h4>
      <div class="reading-progress">
        <div class="progress-bar" id="reading-progress"></div>
      </div>
    </div>
    
    <div class="sidebar-section">
      <h4>ğŸ”— å¿«é€Ÿå°èˆª</h4>
      <ul class="quick-nav">
        <li><a href="{{ '/' | relative_url }}">ğŸ  è¿”å›é¦–é </a></li>
        <li><a href="{{ '/categories.html' | relative_url }}">ğŸ“‚ ç€è¦½åˆ†é¡</a></li>
        <li><a href="{{ '/tags.html' | relative_url }}">ğŸ·ï¸ æŸ¥çœ‹æ¨™ç±¤</a></li>
        <li><a href="{{ '/search.html' | relative_url }}">ğŸ” æœå°‹æ–‡ç« </a></li>
      </ul>
    </div>
  </aside>
</div>

<script>
// ç”Ÿæˆç›®éŒ„
document.addEventListener('DOMContentLoaded', function() {
  const toc = document.getElementById('toc');
  const headings = document.querySelectorAll('.post-content h1, .post-content h2, .post-content h3, .post-content h4');
  
  if (headings.length === 0) {
    document.querySelector('.post-toc').style.display = 'none';
    return;
  }
  
  let tocHTML = '<ul>';
  headings.forEach((heading, index) => {
    const id = `heading-${index}`;
    heading.id = id;
    
    const level = parseInt(heading.tagName.substring(1));
    const indent = (level - 1) * 20;
    const icon = level === 1 ? 'ğŸ“Œ' : level === 2 ? 'ğŸ“' : 'ğŸ“';
    
    tocHTML += `
      <li style="margin-left: ${indent}px;">
        <a href="#${id}" class="toc-link" data-level="${level}">
          ${icon} ${heading.textContent}
        </a>
      </li>
    `;
  });
  tocHTML += '</ul>';
  
  toc.innerHTML = tocHTML;
  
  // é–±è®€é€²åº¦
  const progressBar = document.getElementById('reading-progress');
  window.addEventListener('scroll', function() {
    const post = document.querySelector('.post-content');
    const postTop = post.offsetTop;
    const postHeight = post.offsetHeight;
    const windowTop = window.scrollY;
    const windowHeight = window.innerHeight;
    
    const progress = Math.min(100, Math.max(0, 
      ((windowTop + windowHeight - postTop) / postHeight) * 100
    ));
    
    progressBar.style.width = progress + '%';
  });
  
  // TOC é«˜äº®ç•¶å‰ç« ç¯€
  const tocLinks = document.querySelectorAll('.toc-link');
  window.addEventListener('scroll', function() {
    let current = '';
    headings.forEach(heading => {
      const rect = heading.getBoundingClientRect();
      if (rect.top <= 100) {
        current = heading.id;
      }
    });
    
    tocLinks.forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('href') === '#' + current) {
        link.classList.add('active');
      }
    });
  });
});
</script>

---
layout: three-column
title: 所有文章
permalink: /posts.html
classes: posts-page three-column
---

<!-- 三欄式布局 -->
<div class="three-column-container">
  <!-- 左欄：文章導航 -->
  <aside class="left-sidebar">
    <div class="sidebar-content">
      <div class="nav-card">
        <h3 class="sidebar-title">📚 文章導航</h3>
        <nav class="toc-nav">
          <a href="#all-posts" class="toc-link active" data-view="all">📄 所有文章</a>
          <a href="#categories-view" class="toc-link" data-view="categories">📂 分類檢視</a>
          <a href="#timeline-view" class="toc-link" data-view="timeline">📅 時間軸</a>
        </nav>
      </div>
      
      <div class="nav-card">
        <h3 class="sidebar-title">🔍 快速篩選</h3>
        <div class="filter-controls">
          <div class="filter-group">
            <label>分類：</label>
            <select id="category-filter" class="filter-select">
              <option value="">全部分類</option>
              {% assign categories = site.posts | map: 'categories' | join: ',' | split: ',' | uniq | sort %}
              {% for category in categories %}
                {% unless category == '' %}
                  <option value="{{ category }}">{{ category }}</option>
                {% endunless %}
              {% endfor %}
            </select>
          </div>

          <div class="filter-group">
            <label>標籤：</label>
            <select id="tag-filter" class="filter-select">
              <option value="">全部標籤</option>
              {% assign tags = site.posts | map: 'tags' | join: ',' | split: ',' | uniq | sort %}
              {% for tag in tags %}
                {% unless tag == '' %}
                  <option value="{{ tag }}">{{ tag }}</option>
                {% endunless %}
              {% endfor %}
            </select>
          </div>

          <div class="filter-group">
            <label>搜尋：</label>
            <input type="text" id="search-input" placeholder="搜尋文章..." class="search-input">
          </div>
          
          <button id="clear-filters" class="btn btn-clear">清除篩選</button>
        </div>
      </div>
    </div>
  </aside>

  <!-- 中欄：文章內容 -->
  <main class="main-content">
    <!-- 頁面標題 -->
    <header class="page-header">
      <h1 class="page-title">📚 所有文章</h1>
      <p class="page-description">探索我的所有創作內容</p>
    </header>

    <!-- 文章統計 -->
    <div class="posts-stats">
      <div class="stat-item">
        <span class="stat-number" data-target="{{ site.posts.size }}">0</span>
        <span class="stat-label">篇文章</span>
      </div>
      <div class="stat-item">
        <span class="stat-number" data-target="{{ categories.size }}">0</span>
        <span class="stat-label">個分類</span>
      </div>
      <div class="stat-item">
        <span class="stat-number" data-target="{{ tags.size }}">0</span>
        <span class="stat-label">個標籤</span>
      </div>
    </div>

    <!-- 所有文章檢視 -->
    <section id="all-posts" class="posts-view active">
      <div class="posts-grid" id="posts-container">
        {% assign sorted_posts = site.posts | sort: 'date' | reverse %}
        {% for post in sorted_posts %}
        <article class="article-card" 
                 data-categories="{{ post.categories | join: ',' }}" 
                 data-tags="{{ post.tags | join: ',' }}"
                 data-title="{{ post.title | downcase }}"
                 data-date="{{ post.date | date: '%Y-%m-%d' }}">
          <div class="article-content">
            <div class="article-header">
              <h3 class="article-title">
                <a href="{{ post.url }}">{{ post.title }}</a>
              </h3>
              <div class="article-meta">
                <span class="article-date">📅 {{ post.date | date: "%Y-%m-%d" }}</span>
                {% if post.categories %}
                  {% for category in post.categories %}
                    <span class="article-category">{{ category }}</span>
                  {% endfor %}
                {% endif %}
              </div>
            </div>
            
            <div class="article-excerpt">
              {% if post.excerpt %}
                {{ post.excerpt | strip_html | truncate: 120 }}
              {% else %}
                {{ post.content | strip_html | truncate: 120 }}
              {% endif %}
            </div>
            
            <div class="article-footer">
              <div class="article-tags">
                {% for tag in post.tags limit:3 %}
                  <span class="article-tag">{{ tag }}</span>
                {% endfor %}
              </div>
              <a href="{{ post.url }}" class="btn btn-outline">閱讀更多</a>
            </div>
          </div>
        </article>
        {% endfor %}
      </div>
    </section>

    <!-- 分類檢視 -->
    <section id="categories-view" class="posts-view">
      <div class="categories-section">
        {% assign categories = site.posts | map: 'categories' | join: ',' | split: ',' | uniq | sort %}
        {% for category in categories %}
          {% unless category == '' %}
            <div class="category-group">
              <h3 class="category-title">
                <span class="category-icon">📂</span>
                {{ category }}
                <span class="category-count">({{ site.posts | where: 'categories', category | size }})</span>
              </h3>
              <div class="category-posts">
                {% assign category_posts = site.posts | where: 'categories', category | sort: 'date' | reverse %}
                {% for post in category_posts %}
                  <div class="category-post-item">
                    <a href="{{ post.url }}" class="category-post-link">
                      <span class="category-post-title">{{ post.title }}</span>
                      <span class="category-post-date">{{ post.date | date: "%m-%d" }}</span>
                    </a>
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endunless %}
        {% endfor %}
      </div>
    </section>

    <!-- 時間軸檢視 -->
    <section id="timeline-view" class="posts-view">
      <div class="timeline">
        {% assign posts_by_year = site.posts | group_by_exp: 'post', 'post.date | date: "%Y"' %}
        {% for year_group in posts_by_year %}
          <div class="timeline-year">
            <h3 class="year-title">{{ year_group.name }}年</h3>
            <div class="timeline-posts">
              {% for post in year_group.items %}
                <div class="timeline-item">
                  <div class="timeline-date">{{ post.date | date: "%m-%d" }}</div>
                  <div class="timeline-content">
                    <a href="{{ post.url }}" class="timeline-title">{{ post.title }}</a>
                    {% if post.categories.size > 0 %}
                      <span class="timeline-category">{{ post.categories | first }}</span>
                    {% endif %}
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        {% endfor %}
      </div>
    </section>
  </main>

  <!-- 右欄：個人資訊與快速導航 -->
  <aside class="right-sidebar">
    <div class="sidebar-content">
      <!-- 個人資訊卡 -->
      <div class="info-card security-researcher-card">
        <div class="profile-section">
          <img src="/assets/image/logo_transparent.png" alt="YoFat" class="profile-avatar">
          <h3 class="profile-name">YoFat</h3>
          <p class="profile-title">Security Researcher</p>
        </div>
      </div>

      <!-- 快速導航 -->
      <div class="nav-card">
        <h3 class="sidebar-title">🚀 快速導航</h3>
        <div class="quick-nav">
          <a href="{{ '/' | relative_url }}" class="nav-link">
            <span class="nav-icon">🏠</span>
            <span class="nav-text">首頁</span>
          </a>
          <a href="{{ '/categories.html' | relative_url }}" class="nav-link">
            <span class="nav-icon">📂</span>
            <span class="nav-text">文章分類</span>
          </a>
          <a href="{{ '/tags.html' | relative_url }}" class="nav-link">
            <span class="nav-icon">🏷️</span>
            <span class="nav-text">標籤雲</span>
          </a>
          <a href="{{ '/search.html' | relative_url }}" class="nav-link">
            <span class="nav-icon">🔍</span>
            <span class="nav-text">搜尋文章</span>
          </a>
        </div>
      </div>
    </div>
  </aside>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 統計數字動畫
  function animateNumbers() {
    const statNumbers = document.querySelectorAll('.stat-number');
    
    statNumbers.forEach(number => {
      const target = parseInt(number.getAttribute('data-target'));
      const duration = 2000; // 2秒
      const step = target / (duration / 16); // 60fps
      let current = 0;
      
      const timer = setInterval(() => {
        current += step;
        if (current >= target) {
          number.textContent = target;
          clearInterval(timer);
        } else {
          number.textContent = Math.floor(current);
        }
      }, 16);
    });
  }
  
  // 當頁面載入時觸發動畫
  setTimeout(animateNumbers, 500);
  
  // 檢視切換 - 簡化版本
  function initViewSwitching() {
    const viewLinks = document.querySelectorAll('.toc-link[data-view]');
    const views = document.querySelectorAll('.posts-view');
    
    console.log('初始化檢視切換...');
    console.log('找到的導航鏈接:', viewLinks.length);
    console.log('找到的檢視:', views.length);
    
    viewLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        const viewName = this.getAttribute('data-view');
        console.log('點擊了:', viewName);
        
        // 移除所有 active 狀態
        viewLinks.forEach(l => l.classList.remove('active'));
        views.forEach(v => {
          v.classList.remove('active');
          v.style.display = 'none';
        });
        
        // 設置當前鏈接為 active
        this.classList.add('active');
        
        // 顯示對應的檢視
        let targetViewId;
        if (viewName === 'all') {
          targetViewId = 'all-posts';
        } else {
          targetViewId = viewName + '-view';
        }
        
        const targetView = document.getElementById(targetViewId);
        if (targetView) {
          targetView.classList.add('active');
          targetView.style.display = 'block';
          console.log('成功切換到:', targetViewId);
        } else {
          console.error('找不到目標檢視:', targetViewId);
        }
      });
    });
  }
  
  // 確保 DOM 完全載入後初始化
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initViewSwitching);
  } else {
    initViewSwitching();
  }

  // 篩選功能
  const categoryFilter = document.getElementById('category-filter');
  const tagFilter = document.getElementById('tag-filter');
  const searchInput = document.getElementById('search-input');
  const clearFilters = document.getElementById('clear-filters');
  const postsContainer = document.getElementById('posts-container');

  function filterPosts() {
    const categoryValue = categoryFilter.value.toLowerCase();
    const tagValue = tagFilter.value.toLowerCase();
    const searchValue = searchInput.value.toLowerCase();
    
    const posts = postsContainer.querySelectorAll('.article-card');
    let visibleCount = 0;

    posts.forEach(post => {
      const categories = post.getAttribute('data-categories').toLowerCase();
      const tags = post.getAttribute('data-tags').toLowerCase();
      const title = post.getAttribute('data-title');
      
      const categoryMatch = !categoryValue || categories.includes(categoryValue);
      const tagMatch = !tagValue || tags.includes(tagValue);
      const searchMatch = !searchValue || title.includes(searchValue);
      
      if (categoryMatch && tagMatch && searchMatch) {
        post.style.display = '';
        visibleCount++;
      } else {
        post.style.display = 'none';
      }
    });

    // 更新結果提示
    updateFilterResults(visibleCount, posts.length);
  }

  function updateFilterResults(visible, total) {
    let resultsInfo = document.querySelector('.filter-results');
    if (!resultsInfo) {
      resultsInfo = document.createElement('div');
      resultsInfo.className = 'filter-results';
      postsContainer.parentNode.insertBefore(resultsInfo, postsContainer);
    }
    
    if (visible === total) {
      resultsInfo.innerHTML = '';
    } else {
      resultsInfo.innerHTML = `<p>顯示 ${visible} / ${total} 篇文章</p>`;
    }
  }

  function clearAllFilters() {
    categoryFilter.value = '';
    tagFilter.value = '';
    searchInput.value = '';
    filterPosts();
  }

  // 事件監聽
  categoryFilter.addEventListener('change', filterPosts);
  tagFilter.addEventListener('change', filterPosts);
  searchInput.addEventListener('input', filterPosts);
  clearFilters.addEventListener('click', clearAllFilters);
});
</script>